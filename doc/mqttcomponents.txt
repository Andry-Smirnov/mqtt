
========================================================================
Chapter 1 : Reference for unit 'mqttclient'
========================================================================



------------------------------------------------------------------------
Section 1.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Buffers
Classes
Logging
mqttconsts
mqttpacketdefs
mqttpackets
mqttsubscriptions
mqtttokenizer
System
SysUtils


------------------------------------------------------------------------
Section 1.2 : Constants, types and variables
------------------------------------------------------------------------



1.2.1 : Constants
------------------------------------------------------------------------



MQTT_CONNECT_TIMEOUT = 2


MQTT_DEFAULT_KEEPALIVE = 30


MQTT_DEFAULT_MAX_RESEND_ATTEMPTS = 3


MQTT_DEFAULT_PING_INTERVAL = 15


MQTT_DEFAULT_RESEND_PACKET_TIMEOUT = 2


1.2.2 : Types
------------------------------------------------------------------------



TMQTTClientErrorEvent = procedure(AClient: TMQTTClient; ErrCode: Word; 

                                 ErrMsg: string) of object


TMQTTClientReceiveMessageEvent = procedure(AClient: TMQTTClient; 
      
                                    Topic: UTF8String; 
                
                          Data: string; 
                               
           QOS: TMQTTQOSType; 
                                         
 Retain: Boolean) of object


TMQTTClientSendDataEvent = procedure(AClient: TMQTTClient) of object


TMQTTClientSubscriptionReceiveMessageEvent = procedure
                 
                                     (Subscription:
TMQTTClientSubscription; 
                                              
        Topic: UTF8String; 
                                            
          Data: string; 
                                               
       QOS: TMQTTQOSType; 
                                             
         Retained: Boolean)
                                            
           of object


------------------------------------------------------------------------
Section 1.3 : TMQTTClient
------------------------------------------------------------------------



1.3.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Bail  
Connect  
Connected  
Create  
DataAvailable
Called when data is
available from the network.  Buffer contains the
data to process. 
Destroy  
Disconnect  
Disconnected  
InitSession
 
Loaded  
Publish  
ReceiveMessage  
Reset  
SendData Triggers the
OnSendData event 
Subscribe  
Unsubscribe
 
------------------------------------------------------------------------


1.3.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
CleanSession rw  
ClientID rw  
KeepAlive rw  
MaxResendAttmpts rw
 
OnConnected rw  
OnDisconnect rw  
OnDisconnected rw  
OnError
rw  
OnInitSession rw  This event is fired when a new clean
session needs to be
initialized.
OnReceiveMessage rw  
OnSendData rw
 
PacketIDManager r  
Password rw  
PingInterval rw  
Publishers
r  
RecvBuffer r  
ResendPacketTimeout rw  
SendBuffer r  
Socket
rw  
State r  
Subscriptions r  
Username rw  
WillMessage rw  
------------------------------------------------------------------------

1.3.3 : TMQTTClient.Connected
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Connected;  Virtual

Visibility:
protected


1.3.4 : TMQTTClient.Loaded
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Loaded;  Override

Visibility:
protected


1.3.5 : TMQTTClient.InitSession
------------------------------------------------------------------------


Procedure:

Declaration:

procedure InitSession;  Virtual

Visibility:
protected


1.3.6 : TMQTTClient.SendData
------------------------------------------------------------------------


Procedure:

Synopsis:
Triggers the OnSendData event
Declaration:

procedure SendData;  Virtual

Visibility:
protected


1.3.7 : TMQTTClient.ReceiveMessage
------------------------------------------------------------------------


Procedure:

Declaration:

procedure ReceiveMessage(Topic: UTF8String; Data: string; 
             
          QOS: TMQTTQOSType; Retained: Boolean);  Virtual

Visibility:
protected


1.3.8 : TMQTTClient.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(AOwner: TComponent);  Override

Visibility:
public


1.3.9 : TMQTTClient.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


1.3.10 : TMQTTClient.Reset
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Reset

Visibility:
public


1.3.11 : TMQTTClient.Connect
------------------------------------------------------------------------


Procedure:

Declaration:

function Connect : Boolean

Visibility:
public


1.3.12 : TMQTTClient.Disconnect
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Disconnect

Visibility:
public


1.3.13 : TMQTTClient.Publish
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Publish(Topic: UTF8String; Data: string; QOS: TMQTTQOSType; 
 
               Retain: Boolean; Duplicate: Boolean)

Visibility:
public


1.3.14 : TMQTTClient.Disconnected
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Disconnected;  Virtual

Visibility:
public


1.3.15 : TMQTTClient.Bail
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Bail(ErrCode: Word)

Visibility:
public


1.3.16 : TMQTTClient.Subscribe
------------------------------------------------------------------------


Procedure:

Declaration:

function Subscribe(Subscriptions: TMQTTSubscriptionList) : Boolean

Visibility:
public


1.3.17 : TMQTTClient.Unsubscribe
------------------------------------------------------------------------


Procedure:

Declaration:

function Unsubscribe(Subscriptions: TMQTTSubscriptionList) : Boolean

Visibility:
public


1.3.18 : TMQTTClient.DataAvailable
------------------------------------------------------------------------


Procedure:

Synopsis:
Called when data is available from the network.  Buffer contains the
data to process.
Declaration:

procedure DataAvailable;  Virtual

Visibility:
public


1.3.19 : TMQTTClient.PacketIDManager
------------------------------------------------------------------------



Property:

Declaration:

Property PacketIDManager : TMQTTPacketIDManager

Visibility:
protected

Access:
Read


1.3.20 : TMQTTClient.Publishers
------------------------------------------------------------------------



Property:

Declaration:

Property Publishers : TMQTTClientPublisherList

Visibility:
public

Access:
Read


1.3.21 : TMQTTClient.Subscriptions
------------------------------------------------------------------------



Property:

Declaration:

Property Subscriptions : TMQTTClientSubscriptionList

Visibility:
public

Access:
Read


1.3.22 : TMQTTClient.SendBuffer
------------------------------------------------------------------------



Property:

Declaration:

Property SendBuffer : TBuffer

Visibility:
public

Access:
Read


1.3.23 : TMQTTClient.RecvBuffer
------------------------------------------------------------------------



Property:

Declaration:

Property RecvBuffer : TBuffer

Visibility:
public

Access:
Read


1.3.24 : TMQTTClient.Socket
------------------------------------------------------------------------



Property:

Declaration:

Property Socket : TObject

Visibility:
public

Access:
Read,Write


1.3.25 : TMQTTClient.State
------------------------------------------------------------------------



Property:

Declaration:

Property State : TMQTTConnectionState

Visibility:
public

Access:
Read


1.3.26 : TMQTTClient.ResendPacketTimeout
------------------------------------------------------------------------



Property:

Declaration:

Property ResendPacketTimeout : Word

Visibility:
published

Access:
Read,Write


1.3.27 : TMQTTClient.MaxResendAttmpts
------------------------------------------------------------------------



Property:

Declaration:

Property MaxResendAttmpts : Byte

Visibility:
published

Access:
Read,Write


1.3.28 : TMQTTClient.ClientID
------------------------------------------------------------------------



Property:

Declaration:

Property ClientID : UTF8String

Visibility:
published

Access:
Read,Write


1.3.29 : TMQTTClient.Username
------------------------------------------------------------------------



Property:

Declaration:

Property Username : UTF8String

Visibility:
published

Access:
Read,Write


1.3.30 : TMQTTClient.Password
------------------------------------------------------------------------



Property:

Declaration:

Property Password : AnsiString

Visibility:
published

Access:
Read,Write


1.3.31 : TMQTTClient.WillMessage
------------------------------------------------------------------------



Property:

Declaration:

Property WillMessage : TMQTTWillMessage

Visibility:
published

Access:
Read,Write


1.3.32 : TMQTTClient.CleanSession
------------------------------------------------------------------------



Property:

Declaration:

Property CleanSession : Boolean

Visibility:
published

Access:
Read,Write


1.3.33 : TMQTTClient.KeepAlive
------------------------------------------------------------------------



Property:

Declaration:

Property KeepAlive : Word

Visibility:
published

Access:
Read,Write


1.3.34 : TMQTTClient.PingInterval
------------------------------------------------------------------------



Property:

Declaration:

Property PingInterval : Word

Visibility:
published

Access:
Read,Write


1.3.35 : TMQTTClient.OnConnected
------------------------------------------------------------------------



Property:

Declaration:

Property OnConnected : TNotifyEvent

Visibility:
published

Access:
Read,Write


1.3.36 : TMQTTClient.OnDisconnect
------------------------------------------------------------------------



Property:

Declaration:

Property OnDisconnect : TNotifyEvent

Visibility:
published

Access:
Read,Write


1.3.37 : TMQTTClient.OnDisconnected
------------------------------------------------------------------------



Property:

Declaration:

Property OnDisconnected : TNotifyEvent

Visibility:
published

Access:
Read,Write


1.3.38 : TMQTTClient.OnInitSession
------------------------------------------------------------------------



Property:

Synopsis:
This event is fired when a new clean session needs to be initialized.
Declaration:

Property OnInitSession : TNotifyEvent

Visibility:
published

Access:
Read,Write


1.3.39 : TMQTTClient.OnError
------------------------------------------------------------------------



Property:

Declaration:

Property OnError : TMQTTClientErrorEvent

Visibility:
published

Access:
Read,Write


1.3.40 : TMQTTClient.OnSendData
------------------------------------------------------------------------



Property:

Declaration:

Property OnSendData : TMQTTClientSendDataEvent

Visibility:
published

Access:
Read,Write


1.3.41 : TMQTTClient.OnReceiveMessage
------------------------------------------------------------------------



Property:

Declaration:

Property OnReceiveMessage : TMQTTClientReceiveMessageEvent

Visibility:
published

Access:
Read,Write


------------------------------------------------------------------------
Section 1.4 : TMQTTClientPublisher
------------------------------------------------------------------------



1.4.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Assign  
Changed  
Clear  
Create  
Destroy  
Notification  
Publish
 
------------------------------------------------------------------------


1.4.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
AutoPublish rw  
Client rw  
Data rw  
Enabled rw  
Modified rw 

OnChanged rw  
OnPublish rw  
QOS rw  
Retain rw  
Tokens r  
Topic rw  
------------------------------------------------------------------------


1.4.3 : TMQTTClientPublisher.Notification
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Notification(AComponent: TComponent; Operation: TOperation)
  
                   ;  Override

Visibility:
protected


1.4.4 : TMQTTClientPublisher.Changed
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Changed;  Virtual

Visibility:
protected


1.4.5 : TMQTTClientPublisher.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(AOwner: TComponent);  Override

Visibility:
public


1.4.6 : TMQTTClientPublisher.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


1.4.7 : TMQTTClientPublisher.Assign
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Assign(Source: TPersistent);  Override

Visibility:
public


1.4.8 : TMQTTClientPublisher.Publish
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Publish

Visibility:
public


1.4.9 : TMQTTClientPublisher.Clear
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Clear

Visibility:
public


1.4.10 : TMQTTClientPublisher.Tokens
------------------------------------------------------------------------



Property:

Declaration:

Property Tokens : TMQTTTokenizer

Visibility:
protected

Access:
Read


1.4.11 : TMQTTClientPublisher.Modified
------------------------------------------------------------------------



Property:

Declaration:

Property Modified : Boolean

Visibility:
public

Access:
Read,Write


1.4.12 : TMQTTClientPublisher.Enabled
------------------------------------------------------------------------



Property:

Declaration:

Property Enabled : Boolean

Visibility:
published

Access:
Read,Write


1.4.13 : TMQTTClientPublisher.AutoPublish
------------------------------------------------------------------------



Property:

Declaration:

Property AutoPublish : Boolean

Visibility:
published

Access:
Read,Write


1.4.14 : TMQTTClientPublisher.Client
------------------------------------------------------------------------



Property:

Declaration:

Property Client : TMQTTClient

Visibility:
published

Access:
Read,Write


1.4.15 : TMQTTClientPublisher.Topic
------------------------------------------------------------------------



Property:

Declaration:

Property Topic : string

Visibility:
published

Access:
Read,Write


1.4.16 : TMQTTClientPublisher.Data
------------------------------------------------------------------------



Property:

Declaration:

Property Data : string

Visibility:
published

Access:
Read,Write


1.4.17 : TMQTTClientPublisher.QOS
------------------------------------------------------------------------



Property:

Declaration:

Property QOS : TMQTTQOSType

Visibility:
published

Access:
Read,Write


1.4.18 : TMQTTClientPublisher.Retain
------------------------------------------------------------------------



Property:

Declaration:

Property Retain : Boolean

Visibility:
published

Access:
Read,Write


1.4.19 : TMQTTClientPublisher.OnChanged
------------------------------------------------------------------------



Property:

Declaration:

Property OnChanged : TNotifyEvent

Visibility:
published

Access:
Read,Write


1.4.20 : TMQTTClientPublisher.OnPublish
------------------------------------------------------------------------



Property:

Declaration:

Property OnPublish : TNotifyEvent

Visibility:
published

Access:
Read,Write


------------------------------------------------------------------------
Section 1.5 : TMQTTClientPublisherList
------------------------------------------------------------------------



1.5.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Add  
Create  
Destroy  
Remove  
------------------------------------------------------------------------


1.5.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  
Items r  
------------------------------------------------------------------------


1.5.3 : TMQTTClientPublisherList.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


1.5.4 : TMQTTClientPublisherList.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


1.5.5 : TMQTTClientPublisherList.Add
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Add(AItem: TMQTTClientPublisher)

Visibility:
public


1.5.6 : TMQTTClientPublisherList.Remove
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Remove(AItem: TMQTTClientPublisher)

Visibility:
public


1.5.7 : TMQTTClientPublisherList.Count
------------------------------------------------------------------------



Property:

Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


1.5.8 : TMQTTClientPublisherList.Items
------------------------------------------------------------------------



Property:

Declaration:

Property Items[Index: Integer]: TMQTTClientPublisher; default

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 1.6 : TMQTTClientSubscription
------------------------------------------------------------------------



1.6.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Assign  
Changed  
Clear  
Create  
Destroy  
HandleMessage  
Notification  
SendSubscription  
Subscribe  
Unsubscribe  
------------------------------------------------------------------------


1.6.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Client rw  
Enabled rw  
Filter rw  
Modified rw  
OnChanged rw 

OnMessage rw  
OnSendSubscription rw  
QOS rw  
Tokens r  
------------------------------------------------------------------------


1.6.3 : TMQTTClientSubscription.HandleMessage
------------------------------------------------------------------------


Procedure:

Declaration:

procedure HandleMessage(Topic: UTF8String; Data: string; 
              
        QOS: TMQTTQOSType; Retained: Boolean);  Virtual

Visibility:
protected


1.6.4 : TMQTTClientSubscription.Notification
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Notification(AComponent: TComponent; Operation: TOperation)
  
                   ;  Override

Visibility:
protected


1.6.5 : TMQTTClientSubscription.Changed
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Changed;  Virtual

Visibility:
protected


1.6.6 : TMQTTClientSubscription.SendSubscription
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SendSubscription;  Virtual

Visibility:
protected


1.6.7 : TMQTTClientSubscription.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(AOwner: TComponent);  Override

Visibility:
public


1.6.8 : TMQTTClientSubscription.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


1.6.9 : TMQTTClientSubscription.Assign
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Assign(Source: TPersistent);  Override

Visibility:
public


1.6.10 : TMQTTClientSubscription.Clear
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Clear

Visibility:
public


1.6.11 : TMQTTClientSubscription.Subscribe
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Subscribe

Visibility:
public


1.6.12 : TMQTTClientSubscription.Unsubscribe
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Unsubscribe

Visibility:
public


1.6.13 : TMQTTClientSubscription.Tokens
------------------------------------------------------------------------



Property:

Declaration:

Property Tokens : TMQTTTokenizer

Visibility:
protected

Access:
Read


1.6.14 : TMQTTClientSubscription.Modified
------------------------------------------------------------------------



Property:

Declaration:

Property Modified : Boolean

Visibility:
public

Access:
Read,Write


1.6.15 : TMQTTClientSubscription.Enabled
------------------------------------------------------------------------



Property:

Declaration:

Property Enabled : Boolean

Visibility:
published

Access:
Read,Write


1.6.16 : TMQTTClientSubscription.Filter
------------------------------------------------------------------------



Property:

Declaration:

Property Filter : UTF8String

Visibility:
published

Access:
Read,Write


1.6.17 : TMQTTClientSubscription.QOS
------------------------------------------------------------------------



Property:

Declaration:

Property QOS : TMQTTQOSType

Visibility:
published

Access:
Read,Write


1.6.18 : TMQTTClientSubscription.Client
------------------------------------------------------------------------



Property:

Declaration:

Property Client : TMQTTClient

Visibility:
published

Access:
Read,Write


1.6.19 : TMQTTClientSubscription.OnMessage
------------------------------------------------------------------------



Property:

Declaration:

Property OnMessage : TMQTTClientSubscriptionReceiveMessageEvent

Visibility:
published

Access:
Read,Write


1.6.20 : TMQTTClientSubscription.OnSendSubscription
------------------------------------------------------------------------



Property:

Declaration:

Property OnSendSubscription : TNotifyEvent

Visibility:
published

Access:
Read,Write


1.6.21 : TMQTTClientSubscription.OnChanged
------------------------------------------------------------------------



Property:

Declaration:

Property OnChanged : TNotifyEvent

Visibility:
published

Access:
Read,Write


------------------------------------------------------------------------
Section 1.7 : TMQTTClientSubscriptionList
------------------------------------------------------------------------



1.7.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Add  
Create  
Destroy  
Remove  
------------------------------------------------------------------------


1.7.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  
Items r  
------------------------------------------------------------------------


1.7.3 : TMQTTClientSubscriptionList.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


1.7.4 : TMQTTClientSubscriptionList.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


1.7.5 : TMQTTClientSubscriptionList.Add
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Add(AItem: TMQTTClientSubscription)

Visibility:
public


1.7.6 : TMQTTClientSubscriptionList.Remove
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Remove(AItem: TMQTTClientSubscription)

Visibility:
public


1.7.7 : TMQTTClientSubscriptionList.Count
------------------------------------------------------------------------



Property:

Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


1.7.8 : TMQTTClientSubscriptionList.Items
------------------------------------------------------------------------



Property:

Declaration:

Property Items[Index: Integer]: TMQTTClientSubscription; default

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 1.8 : TMQTTClientThread
------------------------------------------------------------------------



1.8.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Execute  
------------------------------------------------------------------------


1.8.2 : TMQTTClientThread.Execute
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Execute;  Override

Visibility:
protected


========================================================================
Chapter 2 : Reference for unit 'mqttcomponents'
========================================================================



------------------------------------------------------------------------
Section 2.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
LazarusPackageIntf
mqttclient
mqttconsts
mqttmessages
mqttpacketdefs
mqttpackets
mqttregister
mqttserver
mqttsubscriptions
mqtttokenizer
System


========================================================================
Chapter 3 : Reference for unit 'mqttconsts'
========================================================================



------------------------------------------------------------------------
Section 3.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Classes
System
SysUtils


------------------------------------------------------------------------
Section 3.2 : Constants, types and variables
------------------------------------------------------------------------



3.2.1 : Constants
------------------------------------------------------------------------



LM_CLIENT_HAS_CONNECTED = 103


LM_CLIENT_RESET = 106


LM_COULD_NOT_REGISTER_SUBSCRIPTIONS = 102


LM_DUPLICATE_SUBSCRIPTION_REMOVED = 101


LM_INVALID_SUBSCRIPTION_REMOVED = 100


LM_PACKET_UNACKNOWLEDGED_BY_SERVER = 104


LM_RESENDING_PACKET = 105


MQTT_CONNACK_BAD_USERNAME_PASSWORD = 4


MQTT_CONNACK_CLIENTID_REJECTED = 2


MQTT_CONNACK_NOT_AUTHORIZED = 5


MQTT_CONNACK_SERVER_UNAVAILABLE = 3


MQTT_CONNACK_SUCCESS = 0


MQTT_CONNACK_UNACCEPTABLE_PROTOCOL = 1


MQTT_ERROR_ALREADY_CONNECTED = 101


MQTT_ERROR_BAD_USERNAME_PASSWORD = 112


MQTT_ERROR_CLIENTID_REJECTED = 110


MQTT_ERROR_CONNECT_TIMEOUT = 121


MQTT_ERROR_INSUFFICIENT_DATA = 103


MQTT_ERROR_INVALID_PACKET_FLAGS = 105


MQTT_ERROR_INVALID_RETURN_CODES = 120


MQTT_ERROR_INVALID_SUBSCRIPTION_ENTRIES = 119


MQTT_ERROR_NONE = 0


MQTT_ERROR_NOSUBSCRIPTIONSINSUBSCRIBE = 200


MQTT_ERROR_NOT_AUTHORIZED = 113


MQTT_ERROR_NOT_CONNECTED = 102


MQTT_ERROR_NOT_IMPLEMENTED = 122


MQTT_ERROR_NO_CLIENTID = 114


MQTT_ERROR_NO_PING_RESPONSE = 116


MQTT_ERROR_NO_SUBSCRIPTION_LIST = 118


MQTT_ERROR_PACKETID_NOT_FOUND = 124


MQTT_ERROR_PACKET_INVALID = 106


MQTT_ERROR_PACKET_QUEUE_FULL = 123


MQTT_ERROR_PACKET_QUEUE_TIMEOUT = 127


MQTT_ERROR_PAYLOAD_INVALID = 107


MQTT_ERROR_REMAINING_LENGTH_ENCODING = 104


MQTT_ERROR_SEND_PUBCOMP_FAILED = 125


MQTT_ERROR_SEND_PUBREL_FAILED = 126


MQTT_ERROR_SERVER_UNAVAILABLE = 111


MQTT_ERROR_UNACCEPTABLE_PROTOCOL = 109


MQTT_ERROR_UNHANDLED_PACKETTYPE = 117


MQTT_ERROR_UNKNOWN = 1000


MQTT_ERROR_VARHEADER_INVALID = 108


MQTT_ERROR_WILLMESSAGE_INVALID = 115


3.2.2 : Types
------------------------------------------------------------------------



TMQTTConnectionState = (csNew,csConnecting,csConnected,csDisconnecting,

                       csDisconnected)
------------------------------------------------------------------------
Enumeration values for type TMQTTConnectionState
Table 1 :Value
    Explanation
------------------------------------------------------------------------
csConnected
    
csConnecting
    
csDisconnected
    
csDisconnecting
    
csNew
    
------------------------------------------------------------------------


TMQTTLanguagePack = (lpEnglish)
------------------------------------------------------------------------
Enumeration values for type TMQTTLanguagePack
Table 2 :Value
    Explanation
------------------------------------------------------------------------
lpEnglish
    
------------------------------------------------------------------------


TMQTTPacketType = (ptBROKERCONNECT,ptCONNECT,ptCONNACK,ptPUBLISH,
      
            ptPUBACK,ptPUBREC,ptPUBREL,ptPUBCOMP,ptSUBSCRIBE,
          
        ptSUBACK,ptUNSUBSCRIBE,ptUNSUBACK,ptPINGREQ,
                  
ptPINGRESP,ptDISCONNECT,ptReserved15)
------------------------------------------------------------------------
Enumeration values for type TMQTTPacketType
Table 3 :Value
    Explanation
------------------------------------------------------------------------
ptBROKERCONNECT
    
ptCONNACK
    
ptCONNECT
    
ptDISCONNECT
    
ptPINGREQ
    
ptPINGRESP
    
ptPUBACK
    
ptPUBCOMP
    
ptPUBLISH
    
ptPUBREC
    
ptPUBREL
    
ptReserved15
    
ptSUBACK
    
ptSUBSCRIBE
    
ptUNSUBACK
    
ptUNSUBSCRIBE
    
------------------------------------------------------------------------
ptCONNECT,        Client request to connect to Broker ptCONNACK,       
Connect Acknowledgment ptPUBLISH,        Publish Packet ptPUBACK,       
 Publish Acknowledgment ptPUBREC,         Publish Received (assured
delivery part 1) ptPUBREL,         Publish Release (assured delivery
part 2) ptPUBCOMP,       Publish Complete (assured delivery part 3)
ptSUBSCRIBE,      Client Subscribe request ptSUBACK,         Subscribe
Acknowledgment ptUNSUBSCRIBE,   Client Unsubscribe request ptUNSUBACK,  
   Unsubscribe Acknowledgment ptPINGREQ,        PING Request ptPINGRESP,
      PING Response ptDISCONNECT,    Client is Disconnecting

TMQTTQOSType = (qtAT_MOST_ONCE,qtAT_LEAST_ONCE,qtEXACTLY_ONCE,
         
      qtReserved3)
------------------------------------------------------------------------
Enumeration values for type TMQTTQOSType
Table 4 :Value
    Explanation
------------------------------------------------------------------------
qtAT_LEAST_ONCE
    
qtAT_MOST_ONCE
    
qtEXACTLY_ONCE
    
qtReserved3
    
------------------------------------------------------------------------


3.2.3 : Variables
------------------------------------------------------------------------



MQTTLanguagePack : TMQTTLanguagePack = lpEnglish


------------------------------------------------------------------------
Section 3.3 : Procedures and functions
------------------------------------------------------------------------



3.3.1 : GetConnectionStateName
------------------------------------------------------------------------


Procedure:

Declaration:

function GetConnectionStateName(ConnectionState: TMQTTConnectionState)
 
                              : string

Visibility:
default


3.3.2 : GetMQTTErrorMessage
------------------------------------------------------------------------


Procedure:

Synopsis:
Returns a text error message for an MQTT error code
Declaration:

function GetMQTTErrorMessage(ErrCode: Word) : string

Visibility:
default


3.3.3 : GetMQTTLogMessage
------------------------------------------------------------------------


Procedure:

Declaration:

function GetMQTTLogMessage(MessageCode: Word) : string

Visibility:
default


3.3.4 : GetPacketTypeName
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketTypeName(PacketType: TMQTTPacketType) : string

Visibility:
default


3.3.5 : GetQOSTypeName
------------------------------------------------------------------------


Procedure:

Declaration:

function GetQOSTypeName(QOSType: TMQTTQOSType) : string

Visibility:
default


========================================================================
Chapter 4 : Reference for unit 'mqttmessages'
========================================================================



------------------------------------------------------------------------
Section 4.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Classes
mqttconsts
mqtttokenizer
System
SysUtils


------------------------------------------------------------------------
Section 4.2 : TMQTTMessage
------------------------------------------------------------------------



4.2.1 : Description
------------------------------------------------------------------------


An MQTT message 
4.2.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Clone Creates an identical copy
of the message 
Create  
Destroy  
LoadFromStream  
SaveToStream
 
------------------------------------------------------------------------


4.2.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
ClientID rw  The ClientID that sent this retained message. 
Only used for display
purposes.
Data rw  The
MQTT message payload
QOS rw  The QoS
level of the message
Retain rw  Whether or not the server should retain the
message
Tokens r  The
individual
tokens that make up the message
Topic rw  The
MQTT topic string
------------------------------------------------------------------------


4.2.4 : TMQTTMessage.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


4.2.5 : TMQTTMessage.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


4.2.6 : TMQTTMessage.Clone
------------------------------------------------------------------------


Procedure:

Synopsis:
Creates an identical copy of the message
Declaration:

function Clone : TMQTTMessage

Visibility:
public


4.2.7 : TMQTTMessage.LoadFromStream
------------------------------------------------------------------------


Procedure:

Declaration:

procedure LoadFromStream(Stream: TStream)

Visibility:
public


4.2.8 : TMQTTMessage.SaveToStream
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SaveToStream(Stream: TStream)

Visibility:
public


4.2.9 : TMQTTMessage.ClientID
------------------------------------------------------------------------



Property:

Synopsis:
The ClientID that sent this retained message.  Only used for display
purposes.
Declaration:

Property ClientID : UTF8String

Visibility:
public

Access:
Read,Write


4.2.10 : TMQTTMessage.Tokens
------------------------------------------------------------------------



Property:

Synopsis:
The individual tokens that make up the message
Declaration:

Property Tokens : TMQTTTokenizer

Visibility:
public

Access:
Read

Description:
Set the topic string and then read Tokens to parse the topic string into
individual tokens

4.2.11 : TMQTTMessage.Topic
------------------------------------------------------------------------



Property:

Synopsis:
The MQTT topic string
Declaration:

Property Topic : UTF8String

Visibility:
public

Access:
Read,Write


4.2.12 : TMQTTMessage.Data
------------------------------------------------------------------------



Property:

Synopsis:
The MQTT message payload
Declaration:

Property Data : string

Visibility:
public

Access:
Read,Write


4.2.13 : TMQTTMessage.QOS
------------------------------------------------------------------------



Property:

Synopsis:
The QoS level of the message
Declaration:

Property QOS : TMQTTQOSType

Visibility:
public

Access:
Read,Write

Description:
The default is qtAT_LEAST_ONCE

4.2.14 : TMQTTMessage.Retain
------------------------------------------------------------------------



Property:

Synopsis:
Whether or not the server should retain the message
Declaration:

Property Retain : Boolean

Visibility:
public

Access:
Read,Write


------------------------------------------------------------------------
Section 4.3 : TMQTTMessageList
------------------------------------------------------------------------



4.3.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Add
Adds a message to the message list without checking for duplicates 
Clear Clears
the list and
frees all messages stored in it 
Create  
Delete Deletes the message from
the
list but does not destroy it 
DeleteByTopic Deletes all messages from the list
with
a matching topic name 
Destroy  
LoadFromStream  
New Creates a
new message and adds
it to the list 
Remove Removes the message from the list but does not destroy
it 
SaveToStream
 
Update Adds the message to the list, deleting any
existing message with the
same MQTT topic name 
------------------------------------------------------------------------


4.3.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  
Items r  
------------------------------------------------------------------------


4.3.3 : TMQTTMessageList.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


4.3.4 : TMQTTMessageList.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


4.3.5 : TMQTTMessageList.Clear
------------------------------------------------------------------------


Procedure:

Synopsis:
Clears the list and frees all messages stored in it
Declaration:

procedure Clear

Visibility:
public


4.3.6 : TMQTTMessageList.New
------------------------------------------------------------------------


Procedure:

Synopsis:
Creates a new message and adds it to the list
Declaration:

function New(ATopic: UTF8String) : TMQTTMessage

Visibility:
public


4.3.7 : TMQTTMessageList.Add
------------------------------------------------------------------------


Procedure:

Synopsis:
Adds a message to the message list without checking for duplicates
Declaration:

procedure Add(AMessage: TMQTTMessage)

Visibility:
public


4.3.8 : TMQTTMessageList.Update
------------------------------------------------------------------------


Procedure:

Synopsis:
Adds the message to the list, deleting any existing message with the
same MQTT topic name
Declaration:

procedure Update(AMessage: TMQTTMessage)

Visibility:
public

Description:
Update is used to update the list of retained messages ensuring there
are no duplicates

4.3.9 : TMQTTMessageList.Remove
------------------------------------------------------------------------


Procedure:

Synopsis:
Removes the message from the list but does not destroy it
Declaration:

procedure Remove(AMessage: TMQTTMessage)

Visibility:
public


4.3.10 : TMQTTMessageList.Delete
------------------------------------------------------------------------


Procedure:

Synopsis:
Deletes the message from the list but does not destroy it
Declaration:

procedure Delete(Index: Integer)

Visibility:
public


4.3.11 : TMQTTMessageList.DeleteByTopic
------------------------------------------------------------------------


Procedure:

Synopsis:
Deletes all messages from the list with a matching topic name
Declaration:

procedure DeleteByTopic(Topic: UTF8String)

Visibility:
public


4.3.12 : TMQTTMessageList.LoadFromStream
------------------------------------------------------------------------


Procedure:

Declaration:

procedure LoadFromStream(Stream: TStream)

Visibility:
public


4.3.13 : TMQTTMessageList.SaveToStream
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SaveToStream(Stream: TStream)

Visibility:
public


4.3.14 : TMQTTMessageList.Count
------------------------------------------------------------------------



Property:

Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


4.3.15 : TMQTTMessageList.Items
------------------------------------------------------------------------



Property:

Declaration:

Property Items[Index: Integer]: TMQTTMessage; default

Visibility:
public

Access:
Read


========================================================================
Chapter 5 : Reference for unit 'mqttpacketdefs'
========================================================================



------------------------------------------------------------------------
Section 5.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Buffers
Classes
Logging
mqttconsts
mqttpackets
mqttsubscriptions
System
SysUtils


------------------------------------------------------------------------
Section 5.2 : TMQTTCONNACKPacket
------------------------------------------------------------------------



5.2.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer
 
------------------------------------------------------------------------


5.2.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
ReturnCode rw  
SessionPresent rw  
------------------------------------------------------------------------


5.2.3 : TMQTTCONNACKPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.2.4 : TMQTTCONNACKPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.2.5 : TMQTTCONNACKPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.2.6 : TMQTTCONNACKPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


5.2.7 : TMQTTCONNACKPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


5.2.8 : TMQTTCONNACKPacket.ReturnCode
------------------------------------------------------------------------



Property:

Declaration:

Property ReturnCode : Byte

Visibility:
public

Access:
Read,Write


5.2.9 : TMQTTCONNACKPacket.SessionPresent
------------------------------------------------------------------------



Property:

Declaration:

Property SessionPresent : Boolean

Visibility:
public

Access:
Read,Write


------------------------------------------------------------------------
Section 5.3 : TMQTTCONNECTPacket
------------------------------------------------------------------------



5.3.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
Create  
Destroy  
GetPacketType  
ReadFromBuffer  
WriteToBuffer
 
------------------------------------------------------------------------


5.3.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
CleanSession rw  
ClientID rw  
KeepAlive rw  
Password rw  
PasswordFlag
rw  
ReturnCode r  
Username rw  
UsernameFlag rw  
WillMessage
rw  
------------------------------------------------------------------------


5.3.3 : TMQTTCONNECTPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.3.4 : TMQTTCONNECTPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.3.5 : TMQTTCONNECTPacket.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


5.3.6 : TMQTTCONNECTPacket.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


5.3.7 : TMQTTCONNECTPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


5.3.8 : TMQTTCONNECTPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


5.3.9 : TMQTTCONNECTPacket.UsernameFlag
------------------------------------------------------------------------



Property:

Declaration:

Property UsernameFlag : Boolean

Visibility:
public

Access:
Read,Write


5.3.10 : TMQTTCONNECTPacket.PasswordFlag
------------------------------------------------------------------------



Property:

Declaration:

Property PasswordFlag : Boolean

Visibility:
public

Access:
Read,Write


5.3.11 : TMQTTCONNECTPacket.CleanSession
------------------------------------------------------------------------



Property:

Declaration:

Property CleanSession : Boolean

Visibility:
public

Access:
Read,Write


5.3.12 : TMQTTCONNECTPacket.KeepAlive
------------------------------------------------------------------------



Property:

Declaration:

Property KeepAlive : Word

Visibility:
public

Access:
Read,Write


5.3.13 : TMQTTCONNECTPacket.ClientID
------------------------------------------------------------------------



Property:

Declaration:

Property ClientID : UTF8String

Visibility:
public

Access:
Read,Write


5.3.14 : TMQTTCONNECTPacket.Username
------------------------------------------------------------------------



Property:

Declaration:

Property Username : UTF8String

Visibility:
public

Access:
Read,Write


5.3.15 : TMQTTCONNECTPacket.Password
------------------------------------------------------------------------



Property:

Declaration:

Property Password : AnsiString

Visibility:
public

Access:
Read,Write


5.3.16 : TMQTTCONNECTPacket.WillMessage
------------------------------------------------------------------------



Property:

Declaration:

Property WillMessage : TMQTTWillMessage

Visibility:
public

Access:
Read,Write


5.3.17 : TMQTTCONNECTPacket.ReturnCode
------------------------------------------------------------------------



Property:

Declaration:

Property ReturnCode : Byte

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 5.4 : TMQTTDISCONNECTPacket
------------------------------------------------------------------------



5.4.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.4.2 : TMQTTDISCONNECTPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.4.3 : TMQTTDISCONNECTPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.4.4 : TMQTTDISCONNECTPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.4.5 : TMQTTDISCONNECTPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.5 : TMQTTPINGREQPacket
------------------------------------------------------------------------



5.5.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.5.2 : TMQTTPINGREQPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.5.3 : TMQTTPINGREQPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.5.4 : TMQTTPINGREQPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.5.5 : TMQTTPINGREQPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.6 : TMQTTPINGRESPPacket
------------------------------------------------------------------------



5.6.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.6.2 : TMQTTPINGRESPPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.6.3 : TMQTTPINGRESPPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.6.4 : TMQTTPINGRESPPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.6.5 : TMQTTPINGRESPPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.7 : TMQTTPUBACKPacket
------------------------------------------------------------------------



5.7.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.7.2 : TMQTTPUBACKPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.7.3 : TMQTTPUBACKPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.7.4 : TMQTTPUBACKPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.7.5 : TMQTTPUBACKPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.8 : TMQTTPUBCOMPPacket
------------------------------------------------------------------------



5.8.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.8.2 : TMQTTPUBCOMPPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.8.3 : TMQTTPUBCOMPPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.8.4 : TMQTTPUBCOMPPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.8.5 : TMQTTPUBCOMPPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.9 : TMQTTPUBLISHPacket
------------------------------------------------------------------------



5.9.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
Destroy  
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.9.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Data rw  
Duplicate rw  
QOS rw  
Retain rw  
Topic rw  
------------------------------------------------------------------------


5.9.3 : TMQTTPUBLISHPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.9.4 : TMQTTPUBLISHPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.9.5 : TMQTTPUBLISHPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.9.6 : TMQTTPUBLISHPacket.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


5.9.7 : TMQTTPUBLISHPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


5.9.8 : TMQTTPUBLISHPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


5.9.9 : TMQTTPUBLISHPacket.Duplicate
------------------------------------------------------------------------



Property:

Declaration:

Property Duplicate : Boolean

Visibility:
public

Access:
Read,Write


5.9.10 : TMQTTPUBLISHPacket.Retain
------------------------------------------------------------------------



Property:

Declaration:

Property Retain : Boolean

Visibility:
public

Access:
Read,Write


5.9.11 : TMQTTPUBLISHPacket.Topic
------------------------------------------------------------------------



Property:

Declaration:

Property Topic : UTF8String

Visibility:
public

Access:
Read,Write


5.9.12 : TMQTTPUBLISHPacket.Data
------------------------------------------------------------------------



Property:

Declaration:

Property Data : string

Visibility:
public

Access:
Read,Write


5.9.13 : TMQTTPUBLISHPacket.QOS
------------------------------------------------------------------------



Property:

Declaration:

Property QOS : TMQTTQOSType

Visibility:
public

Access:
Read,Write


------------------------------------------------------------------------
Section 5.10 : TMQTTPUBRECPacket
------------------------------------------------------------------------



5.10.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.10.2 : TMQTTPUBRECPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.10.3 : TMQTTPUBRECPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.10.4 : TMQTTPUBRECPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.10.5 : TMQTTPUBRECPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.11 : TMQTTPUBRELPacket
------------------------------------------------------------------------



5.11.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.11.2 : TMQTTPUBRELPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.11.3 : TMQTTPUBRELPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.11.4 : TMQTTPUBRELPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.11.5 : TMQTTPUBRELPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.12 : TMQTTSUBACKPacket
------------------------------------------------------------------------



5.12.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
Create  
Destroy  
GetPacketType  
ReadFromBuffer  
Validate
 
WriteToBuffer  
------------------------------------------------------------------------


5.12.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
ReturnCodes r  
------------------------------------------------------------------------


5.12.3 : TMQTTSUBACKPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.12.4 : TMQTTSUBACKPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.12.5 : TMQTTSUBACKPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.12.6 : TMQTTSUBACKPacket.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


5.12.7 : TMQTTSUBACKPacket.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


5.12.8 : TMQTTSUBACKPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


5.12.9 : TMQTTSUBACKPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


5.12.10 : TMQTTSUBACKPacket.ReturnCodes
------------------------------------------------------------------------



Property:

Declaration:

Property ReturnCodes : TBuffer

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 5.13 : TMQTTSUBSCRIBEPacket
------------------------------------------------------------------------



5.13.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
Create  
Destroy  
GetPacketType  
ReadFromBuffer  
Validate
 
WriteToBuffer  
------------------------------------------------------------------------


5.13.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Subscriptions r  
------------------------------------------------------------------------


5.13.3 : TMQTTSUBSCRIBEPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.13.4 : TMQTTSUBSCRIBEPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.13.5 : TMQTTSUBSCRIBEPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.13.6 : TMQTTSUBSCRIBEPacket.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


5.13.7 : TMQTTSUBSCRIBEPacket.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


5.13.8 : TMQTTSUBSCRIBEPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


5.13.9 : TMQTTSUBSCRIBEPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


5.13.10 : TMQTTSUBSCRIBEPacket.Subscriptions
------------------------------------------------------------------------



Property:

Declaration:

Property Subscriptions : TMQTTSubscriptionList

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 5.14 : TMQTTUNSUBACKPacket
------------------------------------------------------------------------



5.14.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer  
------------------------------------------------------------------------


5.14.2 : TMQTTUNSUBACKPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.14.3 : TMQTTUNSUBACKPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.14.4 : TMQTTUNSUBACKPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.14.5 : TMQTTUNSUBACKPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


------------------------------------------------------------------------
Section 5.15 : TMQTTUNSUBSCRIBEPacket
------------------------------------------------------------------------



5.15.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
Create  
Destroy  
GetPacketType  
ReadFromBuffer  
Validate
 
WriteToBuffer  
------------------------------------------------------------------------


5.15.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Subscriptions r  
------------------------------------------------------------------------


5.15.3 : TMQTTUNSUBSCRIBEPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Override

Visibility:
protected


5.15.4 : TMQTTUNSUBSCRIBEPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Override

Visibility:
protected


5.15.5 : TMQTTUNSUBSCRIBEPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Override

Visibility:
protected


5.15.6 : TMQTTUNSUBSCRIBEPacket.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


5.15.7 : TMQTTUNSUBSCRIBEPacket.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


5.15.8 : TMQTTUNSUBSCRIBEPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


5.15.9 : TMQTTUNSUBSCRIBEPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Override

Visibility:
public


5.15.10 : TMQTTUNSUBSCRIBEPacket.Subscriptions
------------------------------------------------------------------------



Property:

Declaration:

Property Subscriptions : TMQTTSubscriptionList

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 5.16 : TMQTTWillMessage
------------------------------------------------------------------------



5.16.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Assign  
AsString  
Clear  
DisplayText  
------------------------------------------------------------------------


5.16.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Enabled rw  
Message rw  
QOS rw  
Retain rw  
Topic rw  
------------------------------------------------------------------------


5.16.3 : TMQTTWillMessage.Clear
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Clear

Visibility:
public


5.16.4 : TMQTTWillMessage.Assign
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Assign(ASource: TPersistent);  Override

Visibility:
public


5.16.5 : TMQTTWillMessage.DisplayText
------------------------------------------------------------------------


Procedure:

Declaration:

function DisplayText : string

Visibility:
public


5.16.6 : TMQTTWillMessage.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string

Visibility:
public


5.16.7 : TMQTTWillMessage.Retain
------------------------------------------------------------------------



Property:

Declaration:

Property Retain : Boolean

Visibility:
public

Access:
Read,Write


5.16.8 : TMQTTWillMessage.QOS
------------------------------------------------------------------------



Property:

Declaration:

Property QOS : TMQTTQOSType

Visibility:
public

Access:
Read,Write


5.16.9 : TMQTTWillMessage.Enabled
------------------------------------------------------------------------



Property:

Declaration:

Property Enabled : Boolean

Visibility:
public

Access:
Read,Write


5.16.10 : TMQTTWillMessage.Topic
------------------------------------------------------------------------



Property:

Declaration:

Property Topic : UTF8String

Visibility:
public

Access:
Read,Write


5.16.11 : TMQTTWillMessage.Message
------------------------------------------------------------------------



Property:

Declaration:

Property Message : UTF8String

Visibility:
public

Access:
Read,Write


========================================================================
Chapter 6 : Reference for unit 'mqttpackets'
========================================================================



------------------------------------------------------------------------
Section 6.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Buffers
Classes
mqttconsts
System
SysUtils


------------------------------------------------------------------------
Section 6.2 : Constants, types and variables
------------------------------------------------------------------------



6.2.1 : Variables
------------------------------------------------------------------------



PacketList : TMQTTPacketList


------------------------------------------------------------------------
Section 6.3 : Procedures and functions
------------------------------------------------------------------------



6.3.1 : ReadBinaryDataFromBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Reads binary data from a buffer in MQTT protocol format.  Used to store
password
Declaration:

function ReadBinaryDataFromBuffer(ABuffer: TBuffer; 
                   
             out Data: AnsiString) : Boolean

Visibility:
default


6.3.2 : ReadMQTTPacketFromBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Reads the packet type, flags and remaining length of a packet from a
buffer.  Performs validation and returns an error code.  Creates the
appropriate packet class and calls that packet class to finish reading
the packet from the buffer.
Declaration:

function ReadMQTTPacketFromBuffer(ABuffer: TBuffer; 
                   
             out Packet: TMQTTPacket; 
                                
Connected: Boolean) : Word

Visibility:
default


6.3.3 : ReadRemainingLengthFromBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Reads the remaining length of an MQTT packet from a buffer, which is
stored in a special multi-byte format
Declaration:

function ReadRemainingLengthFromBuffer(ABuffer: TBuffer; 
              
                       out Value: DWORD) : Boolean

Visibility:
default


6.3.4 : ReadUTF8StringFromBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Reads a UTF8 String from a buffer in MQTT protocol format
Declaration:

function ReadUTF8StringFromBuffer(ABuffer: TBuffer; out Str: UTF8String)
                                  : Boolean

Visibility:
default


6.3.5 : ReadWordFromBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Reads a word from buffer in network byte order
Declaration:

function ReadWordFromBuffer(ABuffer: TBuffer; out Value: Word) : Boolean

Visibility:
default


6.3.6 : WriteBinaryDataToBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Writes binary data to a buffer in MQTT protocol format.  Used to store
password
Declaration:

procedure WriteBinaryDataToBuffer(ABuffer: TBuffer; Data: AnsiString)

Visibility:
default


6.3.7 : WriteRemainingLengthToBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Writes the remaining length of an MQTT packet to a buffer, which is
stored in a special multi-byte format
Declaration:

procedure WriteRemainingLengthToBuffer(ABuffer: TBuffer; 
              
                       const Value: DWORD)

Visibility:
default


6.3.8 : WriteUTF8StringToBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Writes a UTF8 string to a buffer in MQTT protocol format
Declaration:

procedure WriteUTF8StringToBuffer(ABuffer: TBuffer; Str: UTF8String)

Visibility:
default


6.3.9 : WriteWordToBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Writes a word to a buffer in network byte order
Declaration:

procedure WriteWordToBuffer(ABuffer: TBuffer; const Value: Word)

Visibility:
default


------------------------------------------------------------------------
Section 6.4 : EPacketError
------------------------------------------------------------------------



------------------------------------------------------------------------
Section 6.5 : TMQTTPacket
------------------------------------------------------------------------



6.5.1 : Description
------------------------------------------------------------------------


The base type for packets that are sent and received over the network
6.5.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
Create  
Destroy Destroys the packet 
GetPacketType  
ReadFromBuffer  
Validate  
WriteToBuffer Writes the packet to
ABuffer 
------------------------------------------------------------------------


6.5.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
PacketType r  The packet type
PacketTypeName r  The packet type as a
user
friendly text string
RemainingLength rw  The
remaining length of a packet; the part after
the first byte and
remaining length data.
------------------------------------------------------------------------


6.5.4 : TMQTTPacket.Validate
------------------------------------------------------------------------


Procedure:

Declaration:

function Validate : Boolean;  Virtual

Visibility:
protected


6.5.5 : TMQTTPacket.ReadFromBuffer
------------------------------------------------------------------------


Procedure:

Declaration:

function ReadFromBuffer(ABuffer: TBuffer) : Word;  Virtual;  Abstract

Visibility:
protected


6.5.6 : TMQTTPacket.GetPacketType
------------------------------------------------------------------------


Procedure:

Declaration:

function GetPacketType : TMQTTPacketType;  Virtual;  Abstract

Visibility:
protected


6.5.7 : TMQTTPacket.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


6.5.8 : TMQTTPacket.Destroy
------------------------------------------------------------------------


Procedure:

Synopsis:
Destroys the packet
Declaration:

destructor Destroy;  Override

Visibility:
public


6.5.9 : TMQTTPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Virtual

Visibility:
public


6.5.10 : TMQTTPacket.WriteToBuffer
------------------------------------------------------------------------


Procedure:

Synopsis:
Writes the packet to ABuffer
Declaration:

procedure WriteToBuffer(ABuffer: TBuffer);  Virtual;  Abstract

Visibility:
public


6.5.11 : TMQTTPacket.PacketType
------------------------------------------------------------------------



Property:

Synopsis:
The packet type
Declaration:

Property PacketType : TMQTTPacketType

Visibility:
public

Access:
Read


6.5.12 : TMQTTPacket.PacketTypeName
------------------------------------------------------------------------



Property:

Synopsis:
The packet type as a user friendly text string
Declaration:

Property PacketTypeName : string

Visibility:
public

Access:
Read


6.5.13 : TMQTTPacket.RemainingLength
------------------------------------------------------------------------



Property:

Synopsis:
The remaining length of a packet; the part after the first byte and
remaining length data.
Declaration:

Property RemainingLength : DWORD

Visibility:
public

Access:
Read,Write


------------------------------------------------------------------------
Section 6.6 : TMQTTPacketIDManager
------------------------------------------------------------------------



6.6.1 : Description
------------------------------------------------------------------------


The packet ID manager maintains a list of allocated packet IDs and
generates unique packet ids on request
6.6.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Create  
Destroy  
GenerateID Generate a
unique packet id 
ReleaseID Release a packet ID 
Reset Clears
the list of packet ids 
------------------------------------------------------------------------


6.6.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  The number of packet IDs
in the list
Items r 
An array of packet ids that have been allocated
------------------------------------------------------------------------


6.6.4 : TMQTTPacketIDManager.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


6.6.5 : TMQTTPacketIDManager.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


6.6.6 : TMQTTPacketIDManager.GenerateID
------------------------------------------------------------------------


Procedure:

Synopsis:
Generate a unique packet id
Declaration:

function GenerateID : Word

Visibility:
public


6.6.7 : TMQTTPacketIDManager.ReleaseID
------------------------------------------------------------------------


Procedure:

Synopsis:
Release a packet ID
Declaration:

procedure ReleaseID(PacketID: Word)

Visibility:
public


6.6.8 : TMQTTPacketIDManager.Reset
------------------------------------------------------------------------


Procedure:

Synopsis:
Clears the list of packet ids
Declaration:

procedure Reset

Visibility:
public


6.6.9 : TMQTTPacketIDManager.Count
------------------------------------------------------------------------



Property:

Synopsis:
The number of packet IDs in the list
Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


6.6.10 : TMQTTPacketIDManager.Items
------------------------------------------------------------------------



Property:

Synopsis:
An array of packet ids that have been allocated
Declaration:

Property Items[Index: Integer]: Word

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 6.7 : TMQTTPacketIDPacket
------------------------------------------------------------------------



6.7.1 : Description
------------------------------------------------------------------------


A descendant of TMQTTPacket that introduces the PacketID field
6.7.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
------------------------------------------------------------------------


6.7.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
PacketID rw  A unique 16 bit packet
identifier
------------------------------------------------------------------------


6.7.4 : TMQTTPacketIDPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


6.7.5 : TMQTTPacketIDPacket.PacketID
------------------------------------------------------------------------



Property:

Synopsis:
A unique 16 bit packet identifier
Declaration:

Property PacketID : Word

Visibility:
public

Access:
Read,Write


------------------------------------------------------------------------
Section 6.8 : TMQTTPacketList
------------------------------------------------------------------------



6.8.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Add  
Create  
Destroy  
Dump  
Remove  
------------------------------------------------------------------------


6.8.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  
Items r  
------------------------------------------------------------------------


6.8.3 : TMQTTPacketList.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


6.8.4 : TMQTTPacketList.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


6.8.5 : TMQTTPacketList.Add
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Add(APacket: TMQTTPacket)

Visibility:
public


6.8.6 : TMQTTPacketList.Remove
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Remove(APacket: TMQTTPacket)

Visibility:
public


6.8.7 : TMQTTPacketList.Dump
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Dump(Strings: TStrings)

Visibility:
public


6.8.8 : TMQTTPacketList.Count
------------------------------------------------------------------------



Property:

Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


6.8.9 : TMQTTPacketList.Items
------------------------------------------------------------------------



Property:

Declaration:

Property Items[Index: Integer]: TMQTTPacket; default

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 6.9 : TMQTTPacketQueue
------------------------------------------------------------------------



6.9.1 : Description
------------------------------------------------------------------------


A list of packets.  Not actually a queue
6.9.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Add Adds the packet to the list 
Clear Clears
the packet list
and frees all objects in it 
Create  
Delete Deletes the Packet at
Index
from the list but does not free the packet 
Destroy  
Find Finds a
packet with a matching packet type and packet id. 
Returns nil if not
found. 
Remove Removes a packet by object reference or
by
PacketType and PacketID 
------------------------------------------------------------------------


6.9.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  The number of packets in the
list
Items r  An indexed array
of packets in the list
------------------------------------------------------------------------


6.9.4 : TMQTTPacketQueue.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create

Visibility:
public


6.9.5 : TMQTTPacketQueue.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


6.9.6 : TMQTTPacketQueue.Add
------------------------------------------------------------------------


Procedure:

Synopsis:
Adds the packet to the list
Declaration:

procedure Add(Packet: TMQTTQueuedPacket)

Visibility:
public


6.9.7 : TMQTTPacketQueue.Find
------------------------------------------------------------------------


Procedure:

Synopsis:
Finds a packet with a matching packet type and packet id.  Returns nil
if not found.
Declaration:

function Find(PacketType: TMQTTPacketType; PacketID: Word)
             
: TMQTTQueuedPacket

Visibility:
public


6.9.8 : TMQTTPacketQueue.Remove
------------------------------------------------------------------------


Procedure:

Synopsis:
Removes a packet by object reference or by PacketType and PacketID
Declaration:

procedure Remove(APacket: TMQTTQueuedPacket);  Overload
procedure Remove(PacketType: TMQTTPacketType; PacketID: Word);  Overload

Visibility:
public

Description:
procedure Remove(APacket: TMQTTQueuedPacket); overload; procedure
Remove(PacketType: TMQTTPacketType; PacketID: Word); overload; 

6.9.9 : TMQTTPacketQueue.Delete
------------------------------------------------------------------------


Procedure:

Synopsis:
Deletes the Packet at Index from the list but does not free the packet
Declaration:

procedure Delete(Index: Integer)

Visibility:
public


6.9.10 : TMQTTPacketQueue.Clear
------------------------------------------------------------------------


Procedure:

Synopsis:
Clears the packet list and frees all objects in it
Declaration:

procedure Clear

Visibility:
public


6.9.11 : TMQTTPacketQueue.Items
------------------------------------------------------------------------



Property:

Synopsis:
An indexed array of packets in the list
Declaration:

Property Items[Index: Integer]: TMQTTQueuedPacket; default

Visibility:
public

Access:
Read


6.9.12 : TMQTTPacketQueue.Count
------------------------------------------------------------------------



Property:

Synopsis:
The number of packets in the list
Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 6.10 : TMQTTQueuedPacket
------------------------------------------------------------------------



6.10.1 : Description
------------------------------------------------------------------------


A descendant of TMQTTPacketIDPacket that adds properties for storing the
packet in a packet queue
6.10.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
------------------------------------------------------------------------


6.10.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
ResendCount rw  The
number of times the packet has been resent
SecondsInQueue rw  The number of seconds
the
packet has been in the queue
------------------------------------------------------------------------


6.10.4 : TMQTTQueuedPacket.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string;  Override

Visibility:
public


6.10.5 : TMQTTQueuedPacket.SecondsInQueue
------------------------------------------------------------------------



Property:

Synopsis:
The number of seconds the packet has been in the queue
Declaration:

Property SecondsInQueue : DWORD

Visibility:
public

Access:
Read,Write


6.10.6 : TMQTTQueuedPacket.ResendCount
------------------------------------------------------------------------



Property:

Synopsis:
The number of times the packet has been resent
Declaration:

Property ResendCount : Byte

Visibility:
public

Access:
Read,Write


========================================================================
Chapter 7 : Reference for unit 'mqttregister'
========================================================================



------------------------------------------------------------------------
Section 7.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Classes
mqttclient
mqttserver
System
SysUtils


------------------------------------------------------------------------
Section 7.2 : Procedures and functions
------------------------------------------------------------------------



7.2.1 : Register
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Register

Visibility:
default


========================================================================
Chapter 8 : Reference for unit 'mqttserver'
========================================================================



------------------------------------------------------------------------
Section 8.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Buffers
Classes
Logging
mqttconsts
mqttmessages
mqttpacketdefs
mqttpackets
mqttsubscriptions
System
SysUtils


------------------------------------------------------------------------
Section 8.2 : Constants, types and variables
------------------------------------------------------------------------



8.2.1 : Constants
------------------------------------------------------------------------



MQTT_DEFAULT_KEEPALIVE = 30


MQTT_DEFAULT_MAX_RESEND_ATTEMPTS = 3


MQTT_DEFAULT_MAX_SESSION_AGE = 1080


MQTT_DEFAULT_MAX_SUBSCRIPTION_AGE = 1080


MQTT_DEFAULT_RESEND_PACKET_TIMEOUT = 2


8.2.2 : Types
------------------------------------------------------------------------



TMQTTConnectionDestroyEvent = procedure
                                
       (AConnection: TMQTTServerConnection)
                            
            of object


TMQTTConnectionErrorEvent = procedure
                                  
   (AConnection: TMQTTServerConnection; 
                               
      ErrCode: Word; ErrMsg: string)
                                   
   of object


TMQTTConnectionNotifyEvent = procedure
                                 
     (AConnection: TMQTTServerConnection)
                              
         of object


TMQTTConnectionSendDataEvent = procedure
                               
         (AConnection: TMQTTServerConnection)
                          
               of object


TMQTTDeleteRetainedMessageEvent = procedure
                            
               (Sender: TMQTTRetainedMessagesDatastore; 
               
                            AClient: UTF8String; 
                      
                     ATopic: UTF8String)
                               
             of object


TMQTTRetainedMessageListEvent = procedure
                              
           (Sender: TMQTTRetainedMessagesDatastore; 
                   
                      AMessageList: TMQTTMessageList)
                  
                        of object


TMQTTUpdateRetainedMessageEvent = procedure
                            
               (Sender: TMQTTRetainedMessagesDatastore; 
               
                            AClient: UTF8String; 
                      
                     ATopic: UTF8String; 
                              
             Data: string; 
                                           
QOS: TMQTTQOSType) of object


TMQTTValidateClientIDEvent = procedure(AServer: TMQTTServer; 
          
                            AClientID: UTF8String; 
                    
                  var Allow: Boolean) of object


TMQTTValidatePasswordEvent = procedure(AServer: TMQTTServer; 
          
                            AUsername: UTF8String; 
                    
                  APassword: UTF8String; 
                              
        var Allow: Boolean) of object


TMQTTValidateSubscriptionEvent = procedure
                             
             (AConnection: TMQTTServerConnection; 
                     
                     ASubscription: TMQTTSubscription; 
                
                          var QOS: TMQTTQOSType; 
                      
                    var Allow: Boolean) of object


8.2.3 : Variables
------------------------------------------------------------------------



MQTTStrictClientIDValidationChars : Set of Char = ['0'..'9', 'a'..'z',
'A'..'Z']


------------------------------------------------------------------------
Section 8.3 : EMQTTConnectionError
------------------------------------------------------------------------



------------------------------------------------------------------------
Section 8.4 : TMQTTRetainedMessagesDatastore
------------------------------------------------------------------------



8.4.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
DeleteTopic  
LoadDatastore  
SaveDatastore  
UpdateTopic  
------------------------------------------------------------------------


8.4.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Enabled rw  
Filename rw  
Modified rw  
OnDeleteTopic rw  
OnLoadDatastore
rw  
OnSaveDatastore rw  
OnUpdateTopic rw  
------------------------------------------------------------------------


8.4.3 : TMQTTRetainedMessagesDatastore.LoadDatastore
------------------------------------------------------------------------


Procedure:

Declaration:

procedure LoadDatastore(Messages: TMQTTMessageList);  Virtual

Visibility:
public


8.4.4 : TMQTTRetainedMessagesDatastore.SaveDatastore
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SaveDatastore(Messages: TMQTTMessageList);  Virtual

Visibility:
public


8.4.5 : TMQTTRetainedMessagesDatastore.DeleteTopic
------------------------------------------------------------------------


Procedure:

Declaration:

procedure DeleteTopic(ClientID: UTF8String; Topic: UTF8String);  Virtual

Visibility:
public


8.4.6 : TMQTTRetainedMessagesDatastore.UpdateTopic
------------------------------------------------------------------------


Procedure:

Declaration:

procedure UpdateTopic(ClientID: UTF8String; Topic: UTF8String; 
        
            Data: string; QOS: TMQTTQOSType);  Virtual

Visibility:
public


8.4.7 : TMQTTRetainedMessagesDatastore.Modified
------------------------------------------------------------------------



Property:

Declaration:

Property Modified : Boolean

Visibility:
public

Access:
Read,Write


8.4.8 : TMQTTRetainedMessagesDatastore.Filename
------------------------------------------------------------------------



Property:

Declaration:

Property Filename : string

Visibility:
published

Access:
Read,Write


8.4.9 : TMQTTRetainedMessagesDatastore.Enabled
------------------------------------------------------------------------



Property:

Declaration:

Property Enabled : Boolean

Visibility:
published

Access:
Read,Write


8.4.10 : TMQTTRetainedMessagesDatastore.OnLoadDatastore
------------------------------------------------------------------------



Property:

Declaration:

Property OnLoadDatastore : TMQTTRetainedMessageListEvent

Visibility:
published

Access:
Read,Write


8.4.11 : TMQTTRetainedMessagesDatastore.OnSaveDatastore
------------------------------------------------------------------------



Property:

Declaration:

Property OnSaveDatastore : TMQTTRetainedMessageListEvent

Visibility:
published

Access:
Read,Write


8.4.12 : TMQTTRetainedMessagesDatastore.OnDeleteTopic
------------------------------------------------------------------------



Property:

Declaration:

Property OnDeleteTopic : TMQTTDeleteRetainedMessageEvent

Visibility:
published

Access:
Read,Write


8.4.13 : TMQTTRetainedMessagesDatastore.OnUpdateTopic
------------------------------------------------------------------------



Property:

Declaration:

Property OnUpdateTopic : TMQTTUpdateRetainedMessageEvent

Visibility:
published

Access:
Read,Write


------------------------------------------------------------------------
Section 8.5 : TMQTTServer
------------------------------------------------------------------------



8.5.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Accepted  
ConnectionsChanged  
Create  
Destroy  
DestroyConnection
 
Disconnect  
Disconnected  
DispatchMessage  
Loaded  
Notification
 
RetainedMessagesChanged  
SendData  
SendPendingMessages  
SendRetainedMessages
 
SessionsChanged  
StartConnection  
SubscriptionsChanged  
ValidateClientID
 
ValidatePassword  
------------------------------------------------------------------------


8.5.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
AllowNullClientIDs rw  Allow clients who connect with null
ClientIDs to be assigned random
ClientIDs
Connections r  
Enabled
rw  Setting
Enabled to false will prevent the server from accepting new
connections
KeepAlive rw  The number of seconds of inactivity
before a client
connection times out
MaximumQOS rw  Force the server to
downgrade the
QoS of all messages published
MaxResendAttempts rw  
MaxSessionAge
rw  
MaxSubscriptionAge rw  
OnAccepted rw  Event occurs when a connection is
accepted by the server
OnConnectionDestroy rw  
OnConnectionsChanged
rw  
OnDisconnect rw  
OnDisconnected rw  Event fires when a connection is
disconnected
by the client
OnError rw  
OnRetainedMessagesChanged rw
 
OnSendData rw  
OnSessionsChanged rw  
OnSubscriptionsChanged rw
 
OnValidateClientID rw  
OnValidatePassword rw  
OnValidateSubscription
rw  
RequireAuthentication rw  Require clients to provide a valid
username and password to
connect
ResendPacketTimeout rw  
RetainedMessages
r  
RetainedMessagesDatastore rw  
Sessions r  
StrictClientIDValidation rw  If
True, ClientIDs
may only contain letters and numbers
------------------------------------------------------------------------


8.5.3 : TMQTTServer.Notification
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Notification(AComponent: TComponent; Operation: TOperation)
  
                   ;  Override

Visibility:
protected


8.5.4 : TMQTTServer.Accepted
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Accepted(Connection: TMQTTServerConnection);  Virtual

Visibility:
protected


8.5.5 : TMQTTServer.Disconnected
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Disconnected(Connection: TMQTTServerConnection);  Virtual

Visibility:
protected


8.5.6 : TMQTTServer.Disconnect
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Disconnect(Connection: TMQTTServerConnection);  Virtual

Visibility:
protected


8.5.7 : TMQTTServer.SendData
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SendData(Connection: TMQTTServerConnection);  Virtual

Visibility:
protected


8.5.8 : TMQTTServer.DestroyConnection
------------------------------------------------------------------------


Procedure:

Declaration:

procedure DestroyConnection(Connection: TMQTTServerConnection);  Virtual

Visibility:
protected


8.5.9 : TMQTTServer.ConnectionsChanged
------------------------------------------------------------------------


Procedure:

Declaration:

procedure ConnectionsChanged;  Virtual

Visibility:
protected


8.5.10 : TMQTTServer.SubscriptionsChanged
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SubscriptionsChanged;  Virtual

Visibility:
protected


8.5.11 : TMQTTServer.SessionsChanged
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SessionsChanged;  Virtual

Visibility:
protected


8.5.12 : TMQTTServer.RetainedMessagesChanged
------------------------------------------------------------------------


Procedure:

Declaration:

procedure RetainedMessagesChanged;  Virtual

Visibility:
protected


8.5.13 : TMQTTServer.Loaded
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Loaded;  Override

Visibility:
protected


8.5.14 : TMQTTServer.DispatchMessage
------------------------------------------------------------------------


Procedure:

Declaration:

procedure DispatchMessage(Sender: TMQTTSession; Topic: UTF8String; 
    
                    Data: string; QOS: TMQTTQOSType; 
                  
      Retain: Boolean)

Visibility:
protected


8.5.15 : TMQTTServer.SendPendingMessages
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SendPendingMessages

Visibility:
protected


8.5.16 : TMQTTServer.SendRetainedMessages
------------------------------------------------------------------------


Procedure:

Declaration:

procedure SendRetainedMessages(Session: TMQTTSession; 
                 
            Subscription: TMQTTSubscription)

Visibility:
protected


8.5.17 : TMQTTServer.ValidateClientID
------------------------------------------------------------------------


Procedure:

Declaration:

function ValidateClientID(AClientID: UTF8String) : Boolean;  Virtual

Visibility:
protected


8.5.18 : TMQTTServer.ValidatePassword
------------------------------------------------------------------------


Procedure:

Declaration:

function ValidatePassword(AUsername: UTF8String; APassword: UTF8String)

                         : Boolean;  Virtual

Visibility:
protected


8.5.19 : TMQTTServer.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(AOwner: TComponent);  Override

Visibility:
public


8.5.20 : TMQTTServer.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


8.5.21 : TMQTTServer.StartConnection
------------------------------------------------------------------------


Procedure:

Declaration:

function StartConnection : TMQTTServerConnection;  Virtual

Visibility:
public


8.5.22 : TMQTTServer.ResendPacketTimeout
------------------------------------------------------------------------



Property:

Declaration:

Property ResendPacketTimeout : Byte

Visibility:
protected

Access:
Read,Write


8.5.23 : TMQTTServer.MaxResendAttempts
------------------------------------------------------------------------



Property:

Declaration:

Property MaxResendAttempts : Byte

Visibility:
protected

Access:
Read,Write


8.5.24 : TMQTTServer.Connections
------------------------------------------------------------------------



Property:

Declaration:

Property Connections : TMQTTServerConnectionList

Visibility:
public

Access:
Read


8.5.25 : TMQTTServer.Sessions
------------------------------------------------------------------------



Property:

Declaration:

Property Sessions : TMQTTSessionList

Visibility:
public

Access:
Read


8.5.26 : TMQTTServer.RetainedMessages
------------------------------------------------------------------------



Property:

Declaration:

Property RetainedMessages : TMQTTMessageList

Visibility:
public

Access:
Read


8.5.27 : TMQTTServer.MaxSubscriptionAge
------------------------------------------------------------------------



Property:

Declaration:

Property MaxSubscriptionAge : Word

Visibility:
published

Access:
Read,Write


8.5.28 : TMQTTServer.MaxSessionAge
------------------------------------------------------------------------



Property:

Declaration:

Property MaxSessionAge : Word

Visibility:
published

Access:
Read,Write


8.5.29 : TMQTTServer.KeepAlive
------------------------------------------------------------------------



Property:

Synopsis:
The number of seconds of inactivity before a client connection times out
Declaration:

Property KeepAlive : Integer

Visibility:
published

Access:
Read,Write


8.5.30 : TMQTTServer.Enabled
------------------------------------------------------------------------



Property:

Synopsis:
Setting Enabled to false will prevent the server from accepting new
connections
Declaration:

Property Enabled : Boolean

Visibility:
published

Access:
Read,Write


8.5.31 : TMQTTServer.MaximumQOS
------------------------------------------------------------------------



Property:

Synopsis:
Force the server to downgrade the QoS of all messages published
Declaration:

Property MaximumQOS : TMQTTQOSType

Visibility:
published

Access:
Read,Write

Description:
The server can still recieve messages at any QoS level but will limit
the QoS of any messages it sends.

8.5.32 : TMQTTServer.RequireAuthentication
------------------------------------------------------------------------



Property:

Synopsis:
Require clients to provide a valid username and password to connect
Declaration:

Property RequireAuthentication : Boolean

Visibility:
published

Access:
Read,Write

Description:
If false, a username and password will be validated if it is provided
but connections where no username and password are provided will also be
allowed.  If a username and password are provided, the session will be
associated with a user object.  The default is false.

8.5.33 : TMQTTServer.AllowNullClientIDs
------------------------------------------------------------------------



Property:

Synopsis:
Allow clients who connect with null ClientIDs to be assigned random
ClientIDs
Declaration:

Property AllowNullClientIDs : Boolean

Visibility:
published

Access:
Read,Write

Description:
Default is True.  When set to false, clients connecting with NULL
ClientIDs will recieve MQTT_CONNACK_CLIENTID_REJECTED

8.5.34 : TMQTTServer.StrictClientIDValidation
------------------------------------------------------------------------



Property:

Synopsis:
If True, ClientIDs may only contain letters and numbers
Declaration:

Property StrictClientIDValidation : Boolean

Visibility:
published

Access:
Read,Write


8.5.35 : TMQTTServer.RetainedMessagesDatastore
------------------------------------------------------------------------



Property:

Declaration:

Property RetainedMessagesDatastore : TMQTTRetainedMessagesDatastore

Visibility:
published

Access:
Read,Write


8.5.36 : TMQTTServer.OnAccepted
------------------------------------------------------------------------



Property:

Synopsis:
Event occurs when a connection is accepted by the server
Declaration:

Property OnAccepted : TMQTTConnectionNotifyEvent

Visibility:
published

Access:
Read,Write


8.5.37 : TMQTTServer.OnDisconnect
------------------------------------------------------------------------



Property:

Declaration:

Property OnDisconnect : TMQTTConnectionNotifyEvent

Visibility:
published

Access:
Read,Write


8.5.38 : TMQTTServer.OnDisconnected
------------------------------------------------------------------------



Property:

Synopsis:
Event fires when a connection is disconnected by the client
Declaration:

Property OnDisconnected : TMQTTConnectionNotifyEvent

Visibility:
published

Access:
Read,Write


8.5.39 : TMQTTServer.OnSendData
------------------------------------------------------------------------



Property:

Declaration:

Property OnSendData : TMQTTConnectionSendDataEvent

Visibility:
published

Access:
Read,Write


8.5.40 : TMQTTServer.OnError
------------------------------------------------------------------------



Property:

Declaration:

Property OnError : TMQTTConnectionErrorEvent

Visibility:
published

Access:
Read,Write


8.5.41 : TMQTTServer.OnConnectionsChanged
------------------------------------------------------------------------



Property:

Declaration:

Property OnConnectionsChanged : TNotifyEvent

Visibility:
published

Access:
Read,Write


8.5.42 : TMQTTServer.OnConnectionDestroy
------------------------------------------------------------------------



Property:

Declaration:

Property OnConnectionDestroy : TMQTTConnectionDestroyEvent

Visibility:
published

Access:
Read,Write


8.5.43 : TMQTTServer.OnValidateSubscription
------------------------------------------------------------------------



Property:

Declaration:

Property OnValidateSubscription : TMQTTValidateSubscriptionEvent

Visibility:
published

Access:
Read,Write


8.5.44 : TMQTTServer.OnValidateClientID
------------------------------------------------------------------------



Property:

Declaration:

Property OnValidateClientID : TMQTTValidateClientIDEvent

Visibility:
published

Access:
Read,Write


8.5.45 : TMQTTServer.OnValidatePassword
------------------------------------------------------------------------



Property:

Declaration:

Property OnValidatePassword : TMQTTValidatePasswordEvent

Visibility:
published

Access:
Read,Write


8.5.46 : TMQTTServer.OnSubscriptionsChanged
------------------------------------------------------------------------



Property:

Declaration:

Property OnSubscriptionsChanged : TNotifyEvent

Visibility:
published

Access:
Read,Write


8.5.47 : TMQTTServer.OnSessionsChanged
------------------------------------------------------------------------



Property:

Declaration:

Property OnSessionsChanged : TNotifyEvent

Visibility:
published

Access:
Read,Write


8.5.48 : TMQTTServer.OnRetainedMessagesChanged
------------------------------------------------------------------------



Property:

Declaration:

Property OnRetainedMessagesChanged : TNotifyEvent

Visibility:
published

Access:
Read,Write


------------------------------------------------------------------------
Section 8.6 : TMQTTServerConnection
------------------------------------------------------------------------



8.6.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Create  
DataAvailable  
Destroy  
Disconnected Responds to a client
disconnecting the network connection. 
Publish Sends an MQTT PUBLISH message
to the client 
------------------------------------------------------------------------


8.6.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
ClientIDGenerated rw  
RecvBuffer r  
SendBuffer r  
Server r  
Session
r  
Socket rw  
State r  
Username r  
WillMessage rw  
------------------------------------------------------------------------


8.6.3 : TMQTTServerConnection.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(AServer: TMQTTServer)

Visibility:
public


8.6.4 : TMQTTServerConnection.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


8.6.5 : TMQTTServerConnection.Publish
------------------------------------------------------------------------


Procedure:

Synopsis:
Sends an MQTT PUBLISH message to the client
Declaration:

procedure Publish(Topic: UTF8String; Data: string; QOS: TMQTTQOSType; 
 
               Retain: Boolean; Duplicate: Boolean)

Visibility:
public

Description:
Topic: The topic string Data: The message payload QoS: The QoS to use
while sending the message Retain: The status of the retain flag in the
message Duplicate: The status of the duplicate flag in the message  When
sending a PUBLISH Packet to a Client the Server MUST set the RETAIN flag
to 1 if a message is sent as a result of a new subscription being made
by a Client [MQTT-3.3.1-8].   It MUST set the RETAIN flag to 0 when a
PUBLISH Packet is sent to a Client because it matches an established
subscription regardless of how the flag was set in the message it
received [MQTT-3.3.1-9].

8.6.6 : TMQTTServerConnection.Disconnected
------------------------------------------------------------------------


Procedure:

Synopsis:
Responds to a client disconnecting the network connection.
Declaration:

procedure Disconnected

Visibility:
public

Description:
If a client connection terminates unexpectedly the server sends the will
message associated with that connection if one was provided.

8.6.7 : TMQTTServerConnection.DataAvailable
------------------------------------------------------------------------


Procedure:

Declaration:

procedure DataAvailable(Buffer: TBuffer)

Visibility:
public


8.6.8 : TMQTTServerConnection.SendBuffer
------------------------------------------------------------------------



Property:

Declaration:

Property SendBuffer : TBuffer

Visibility:
public

Access:
Read


8.6.9 : TMQTTServerConnection.RecvBuffer
------------------------------------------------------------------------



Property:

Declaration:

Property RecvBuffer : TBuffer

Visibility:
public

Access:
Read


8.6.10 : TMQTTServerConnection.Socket
------------------------------------------------------------------------



Property:

Declaration:

Property Socket : TObject

Visibility:
public

Access:
Read,Write


8.6.11 : TMQTTServerConnection.State
------------------------------------------------------------------------



Property:

Declaration:

Property State : TMQTTConnectionState

Visibility:
public

Access:
Read


8.6.12 : TMQTTServerConnection.WillMessage
------------------------------------------------------------------------



Property:

Declaration:

Property WillMessage : TMQTTWillMessage

Visibility:
public

Access:
Read,Write


8.6.13 : TMQTTServerConnection.Server
------------------------------------------------------------------------



Property:

Declaration:

Property Server : TMQTTServer

Visibility:
public

Access:
Read


8.6.14 : TMQTTServerConnection.Session
------------------------------------------------------------------------



Property:

Declaration:

Property Session : TMQTTSession

Visibility:
public

Access:
Read


8.6.15 : TMQTTServerConnection.Username
------------------------------------------------------------------------



Property:

Declaration:

Property Username : UTF8String

Visibility:
public

Access:
Read


8.6.16 : TMQTTServerConnection.ClientIDGenerated
------------------------------------------------------------------------



Property:

Declaration:

Property ClientIDGenerated : Boolean

Visibility:
public

Access:
Read,Write


------------------------------------------------------------------------
Section 8.7 : TMQTTServerConnectionList
------------------------------------------------------------------------



8.7.1 : Description
------------------------------------------------------------------------


Maintains a list of TMQTTServerConnection objects
8.7.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Add Adds a connection to  the list 
Clear Frees
all the
connections in the list and clears the list 
Create Creates a server
connection list 
Delete Deletes the
connection at index'th position
in the Items array.  Does not close or
free the connection. 
Destroy  
Remove Removes a connection from the list.  Does not close or
free the
connection 
------------------------------------------------------------------------


8.7.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  
Items r  
------------------------------------------------------------------------


8.7.4 : TMQTTServerConnectionList.Create
------------------------------------------------------------------------


Procedure:

Synopsis:
Creates a server connection list
Declaration:

constructor Create

Visibility:
public


8.7.5 : TMQTTServerConnectionList.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


8.7.6 : TMQTTServerConnectionList.Clear
------------------------------------------------------------------------


Procedure:

Synopsis:
Frees all the connections in the list and clears the list
Declaration:

procedure Clear

Visibility:
public


8.7.7 : TMQTTServerConnectionList.Add
------------------------------------------------------------------------


Procedure:

Synopsis:
Adds a connection to  the list
Declaration:

procedure Add(AConnection: TMQTTServerConnection)

Visibility:
public


8.7.8 : TMQTTServerConnectionList.Remove
------------------------------------------------------------------------


Procedure:

Synopsis:
Removes a connection from the list.  Does not close or free the
connection
Declaration:

procedure Remove(AConnection: TMQTTServerConnection)

Visibility:
public


8.7.9 : TMQTTServerConnectionList.Delete
------------------------------------------------------------------------


Procedure:

Synopsis:
Deletes the connection at index'th position in the Items array.  Does
not close or free the connection.
Declaration:

procedure Delete(Index: Integer)

Visibility:
public


8.7.10 : TMQTTServerConnectionList.Count
------------------------------------------------------------------------



Property:

Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


8.7.11 : TMQTTServerConnectionList.Items
------------------------------------------------------------------------



Property:

Declaration:

Property Items[Index: Integer]: TMQTTServerConnection; default

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 8.8 : TMQTTServerThread
------------------------------------------------------------------------



8.8.1 : Description
------------------------------------------------------------------------


TMQTTServerThread calls TMQTTServer.HandleTimer every second
8.8.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Execute  
------------------------------------------------------------------------


8.8.3 : TMQTTServerThread.Execute
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Execute;  Override

Visibility:
protected


------------------------------------------------------------------------
Section 8.9 : TMQTTSession
------------------------------------------------------------------------



8.9.1 : Description
------------------------------------------------------------------------


A session may persist between different connections, i.e. a client may
reconnect to an existing session.
8.9.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Clean  
Create  
Destroy  
------------------------------------------------------------------------


8.9.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Age rw  
ClientID r  
Connection rw  
Description rw  
MaximumQOS rw  The
maximum QOS at which the session can publish messages
Server r  
Subscriptions
r  
------------------------------------------------------------------------


8.9.4 : TMQTTSession.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(AServer: TMQTTServer; AClientID: UTF8String)

Visibility:
public


8.9.5 : TMQTTSession.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


8.9.6 : TMQTTSession.Clean
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Clean

Visibility:
public


8.9.7 : TMQTTSession.Subscriptions
------------------------------------------------------------------------



Property:

Declaration:

Property Subscriptions : TMQTTSubscriptionList

Visibility:
public

Access:
Read


8.9.8 : TMQTTSession.Server
------------------------------------------------------------------------



Property:

Declaration:

Property Server : TMQTTServer

Visibility:
public

Access:
Read


8.9.9 : TMQTTSession.Connection
------------------------------------------------------------------------



Property:

Declaration:

Property Connection : TMQTTServerConnection

Visibility:
public

Access:
Read,Write


8.9.10 : TMQTTSession.ClientID
------------------------------------------------------------------------



Property:

Declaration:

Property ClientID : UTF8String

Visibility:
public

Access:
Read


8.9.11 : TMQTTSession.Description
------------------------------------------------------------------------



Property:

Declaration:

Property Description : string

Visibility:
public

Access:
Read,Write


8.9.12 : TMQTTSession.MaximumQOS
------------------------------------------------------------------------



Property:

Synopsis:
The maximum QOS at which the session can publish messages
Declaration:

Property MaximumQOS : TMQTTQOSType

Visibility:
public

Access:
Read,Write

Description:
This property forces a QoS downgrade for particular clients that can't
handle all QoS levels

8.9.13 : TMQTTSession.Age
------------------------------------------------------------------------



Property:

Declaration:

Property Age : Integer

Visibility:
public

Access:
Read,Write


------------------------------------------------------------------------
Section 8.10 : TMQTTSessionList
------------------------------------------------------------------------



8.10.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Add  
Clear  
Create  
Delete  
Destroy  
Find  
GetUniqueClientID
 
IsStrictlyValid  
New  
Remove  
------------------------------------------------------------------------


8.10.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  
Items r  
Server r  
------------------------------------------------------------------------


8.10.3 : TMQTTSessionList.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(AServer: TMQTTServer)

Visibility:
public


8.10.4 : TMQTTSessionList.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


8.10.5 : TMQTTSessionList.Clear
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Clear

Visibility:
public


8.10.6 : TMQTTSessionList.IsStrictlyValid
------------------------------------------------------------------------


Procedure:

Declaration:

function IsStrictlyValid(ClientID: UTF8String) : Boolean

Visibility:
public


8.10.7 : TMQTTSessionList.GetUniqueClientID
------------------------------------------------------------------------


Procedure:

Declaration:

function GetUniqueClientID : UTF8String

Visibility:
public


8.10.8 : TMQTTSessionList.New
------------------------------------------------------------------------


Procedure:

Declaration:

function New(ClientID: UTF8String) : TMQTTSession

Visibility:
public


8.10.9 : TMQTTSessionList.Add
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Add(AItem: TMQTTSession)

Visibility:
public


8.10.10 : TMQTTSessionList.Find
------------------------------------------------------------------------


Procedure:

Declaration:

function Find(ClientID: UTF8String) : TMQTTSession

Visibility:
public


8.10.11 : TMQTTSessionList.Delete
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Delete(Index: Integer)

Visibility:
public


8.10.12 : TMQTTSessionList.Remove
------------------------------------------------------------------------


Procedure:

Declaration:

procedure Remove(AItem: TMQTTSession)

Visibility:
public


8.10.13 : TMQTTSessionList.Server
------------------------------------------------------------------------



Property:

Declaration:

Property Server : TMQTTServer

Visibility:
public

Access:
Read


8.10.14 : TMQTTSessionList.Count
------------------------------------------------------------------------



Property:

Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


8.10.15 : TMQTTSessionList.Items
------------------------------------------------------------------------



Property:

Declaration:

Property Items[Index: Integer]: TMQTTSession; default

Visibility:
public

Access:
Read


========================================================================
Chapter 9 : Reference for unit 'mqttsubscriptions'
========================================================================



------------------------------------------------------------------------
Section 9.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Classes
mqttconsts
mqtttokenizer
System
SysUtils


------------------------------------------------------------------------
Section 9.2 : TMQTTSubscription
------------------------------------------------------------------------



9.2.1 : Description
------------------------------------------------------------------------


Represents a subscription to a topic
9.2.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Assign
Copies the contents of ASource into this object.  Resets Age to zero. 
Create Creates
a subscription, optionally assigning a
Filter and QoS but does not add
it to any list 
Destroy Destroys the
subscription but does not remove it from any list 
------------------------------------------------------------------------


9.2.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Age rw  The age
of the subscription in minutes.  At certain intervals,
subscriptions
older than a certain age will be removed.
Filter
rw  The filter as a UTF8String
QOS rw  The
QoS of the subscription
Tokens r  The tokenized filter string.  Set
Filter and
then read Tokens to parse.
------------------------------------------------------------------------


9.2.4 : TMQTTSubscription.Create
------------------------------------------------------------------------


Procedure:

Synopsis:
Creates a subscription, optionally assigning a Filter and QoS but does
not add it to any list
Declaration:

constructor Create(AFilter: UTF8String; AQOS: TMQTTQOSType)

Visibility:
public


9.2.5 : TMQTTSubscription.Destroy
------------------------------------------------------------------------


Procedure:

Synopsis:
Destroys the subscription but does not remove it from any list
Declaration:

destructor Destroy;  Override

Visibility:
public


9.2.6 : TMQTTSubscription.Assign
------------------------------------------------------------------------


Procedure:

Synopsis:
Copies the contents of ASource into this object.  Resets Age to zero.
Declaration:

procedure Assign(ASource: TMQTTSubscription)

Visibility:
public


9.2.7 : TMQTTSubscription.QOS
------------------------------------------------------------------------



Property:

Synopsis:
The QoS of the subscription
Declaration:

Property QOS : TMQTTQOSType

Visibility:
public

Access:
Read,Write

Description:
TMQTTQOSType =   (     qtAT_MOST_ONCE,   //  0 At most once Fire and
Forget        <=1     qtAT_LEAST_ONCE,  //  1 At least once Acknowledged
delivery >=1     qtEXACTLY_ONCE,   //  2 Exactly once Assured delivery  
    =1     qtReserved3	      //  3 Reserved   );   

9.2.8 : TMQTTSubscription.Filter
------------------------------------------------------------------------



Property:

Synopsis:
The filter as a UTF8String
Declaration:

Property Filter : UTF8String

Visibility:
public

Access:
Read,Write


9.2.9 : TMQTTSubscription.Tokens
------------------------------------------------------------------------



Property:

Synopsis:
The tokenized filter string.  Set Filter and then read Tokens to parse.
Declaration:

Property Tokens : TMQTTTokenizer

Visibility:
public

Access:
Read


9.2.10 : TMQTTSubscription.Age
------------------------------------------------------------------------



Property:

Synopsis:
The age of the subscription in minutes.  At certain intervals,
subscriptions older than a certain age will be removed.
Declaration:

Property Age : Integer

Visibility:
public

Access:
Read,Write

Description:
Currently this is set to 1080 minutes or 18 hours.

------------------------------------------------------------------------
Section 9.3 : TMQTTSubscriptionList
------------------------------------------------------------------------



9.3.1 : Description
------------------------------------------------------------------------


A list of subscriptions
9.3.2 : Method overview
------------------------------------------------------------------------


Method Description
------------------
Assign Clears the subscription list and replaces it with the
contents of
ASource 
Clear Clears the subscription list, destroying all
objects it contains 
Create Creates a
new subscription list 
Delete Deletes the index'th subscription and frees the
subscription 
DeleteList
Deletes a list of subscriptions from this list 
Destroy Destroys the
subscription list and all subscriptions it contains 
Find Finds a
subscription by Filter.  Returns nil if no match was found. 
MergeList Merges a
list of subscriptions into this subscription list.  Any duplicates
subscriptions are updated with the new subscriptions. 
New Creates a
new
subscription and returns the result.  If a subscription with the
same
filter already exists it is updated and returned instead. 
Remove Removes
a
subscription from the list and destroys it 
RemoveDuplicates  
RemoveInvalidSubscriptions Deletes
and frees any
subscriptions with invalid tokens.  Returns the number of
subscriptions
removed. 
Update Adds or updates a
subscription.  If a subscription with a
matching filter already exists,
it is updated. 
------------------------------------------------------------------------


9.3.3 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  The number of
subscriptions in the list
Items r  An indexed array[0..Count-1] of
subscriptions
------------------------------------------------------------------------


9.3.4 : TMQTTSubscriptionList.Create
------------------------------------------------------------------------


Procedure:

Synopsis:
Creates a new subscription list
Declaration:

constructor Create

Visibility:
public


9.3.5 : TMQTTSubscriptionList.Destroy
------------------------------------------------------------------------


Procedure:

Synopsis:
Destroys the subscription list and all subscriptions it contains
Declaration:

destructor Destroy;  Override

Visibility:
public


9.3.6 : TMQTTSubscriptionList.Assign
------------------------------------------------------------------------


Procedure:

Synopsis:
Clears the subscription list and replaces it with the contents of
ASource
Declaration:

procedure Assign(ASource: TMQTTSubscriptionList)

Visibility:
public


9.3.7 : TMQTTSubscriptionList.Clear
------------------------------------------------------------------------


Procedure:

Synopsis:
Clears the subscription list, destroying all objects it contains
Declaration:

procedure Clear

Visibility:
public


9.3.8 : TMQTTSubscriptionList.New
------------------------------------------------------------------------


Procedure:

Synopsis:
Creates a new subscription and returns the result.  If a subscription
with the same filter already exists it is updated and returned instead.
Declaration:

function New(AFilter: UTF8String; AQOS: TMQTTQOSType)
             :
TMQTTSubscription

Visibility:
public


9.3.9 : TMQTTSubscriptionList.Update
------------------------------------------------------------------------


Procedure:

Synopsis:
Adds or updates a subscription.  If a subscription with a matching
filter already exists, it is updated.
Declaration:

procedure Update(ASubscription: TMQTTSubscription)

Visibility:
public


9.3.10 : TMQTTSubscriptionList.Find
------------------------------------------------------------------------


Procedure:

Synopsis:
Finds a subscription by Filter.  Returns nil if no match was found.
Declaration:

function Find(AFilter: UTF8String) : TMQTTSubscription

Visibility:
public


9.3.11 : TMQTTSubscriptionList.Remove
------------------------------------------------------------------------


Procedure:

Synopsis:
Removes a subscription from the list and destroys it
Declaration:

procedure Remove(ASubscription: TMQTTSubscription)

Visibility:
public


9.3.12 : TMQTTSubscriptionList.Delete
------------------------------------------------------------------------


Procedure:

Synopsis:
Deletes the index'th subscription and frees the subscription
Declaration:

procedure Delete(Index: Integer)

Visibility:
public


9.3.13 : TMQTTSubscriptionList.MergeList
------------------------------------------------------------------------


Procedure:

Synopsis:
Merges a list of subscriptions into this subscription list.  Any
duplicates subscriptions are updated with the new subscriptions.
Declaration:

procedure MergeList(AList: TMQTTSubscriptionList)

Visibility:
public


9.3.14 : TMQTTSubscriptionList.DeleteList
------------------------------------------------------------------------


Procedure:

Synopsis:
Deletes a list of subscriptions from this list
Declaration:

procedure DeleteList(AList: TMQTTSubscriptionList)

Visibility:
public


9.3.15 : TMQTTSubscriptionList.RemoveDuplicates
------------------------------------------------------------------------


Procedure:

Declaration:

function RemoveDuplicates : Integer

Visibility:
public


9.3.16 : TMQTTSubscriptionList.RemoveInvalidSubscriptions
------------------------------------------------------------------------


Procedure:

Synopsis:
Deletes and frees any subscriptions with invalid tokens.  Returns the
number of subscriptions removed.
Declaration:

function RemoveInvalidSubscriptions : Integer

Visibility:
public


9.3.17 : TMQTTSubscriptionList.Count
------------------------------------------------------------------------



Property:

Synopsis:
The number of subscriptions in the list
Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


9.3.18 : TMQTTSubscriptionList.Items
------------------------------------------------------------------------



Property:

Synopsis:
An indexed array[0..Count-1] of subscriptions
Declaration:

Property Items[Index: Integer]: TMQTTSubscription; default

Visibility:
public

Access:
Read


========================================================================
Chapter 10 : Reference for unit 'mqtttokenizer'
========================================================================



------------------------------------------------------------------------
Section 10.1 : Used units
------------------------------------------------------------------------


Unit Name
---------
Classes
Logging
mqttconsts
System
SysUtils


------------------------------------------------------------------------
Section 10.2 : Constants, types and variables
------------------------------------------------------------------------



10.2.1 : Types
------------------------------------------------------------------------



TMQTTTokenKind = (tkInvalid,tkValid,tkMultiLevel,tkSingleLevel)
------------------------------------------------------------------------
Enumeration values for type TMQTTTokenKind
Table 5 :Value
    Explanation
------------------------------------------------------------------------
tkInvalid
    
tkMultiLevel
    
tkSingleLevel
    
tkValid
    
------------------------------------------------------------------------


------------------------------------------------------------------------
Section 10.3 : Procedures and functions
------------------------------------------------------------------------



10.3.1 : CheckTopicMatchesFilter
------------------------------------------------------------------------


Procedure:

Declaration:

function CheckTopicMatchesFilter(Topic: TMQTTTokenizer; 
               
                Filter: TMQTTTokenizer) : Boolean

Visibility:
default


------------------------------------------------------------------------
Section 10.4 : TMQTTToken
------------------------------------------------------------------------



10.4.1 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Kind r  
Text r  
------------------------------------------------------------------------


10.4.2 : TMQTTToken.Kind
------------------------------------------------------------------------



Property:

Declaration:

Property Kind : TMQTTTokenKind

Visibility:
public

Access:
Read


10.4.3 : TMQTTToken.Text
------------------------------------------------------------------------



Property:

Declaration:

Property Text : UTF8String

Visibility:
public

Access:
Read


------------------------------------------------------------------------
Section 10.5 : TMQTTTokenizer
------------------------------------------------------------------------



10.5.1 : Method overview
------------------------------------------------------------------------


Method Description
------------------
AsString  
Create  
Destroy  
------------------------------------------------------------------------


10.5.2 : Property overview
------------------------------------------------------------------------


Properties Access Description
-----------------------------
Count r  
Items r  
Valid r  
------------------------------------------------------------------------


10.5.3 : TMQTTTokenizer.Create
------------------------------------------------------------------------


Procedure:

Declaration:

constructor Create(Str: UTF8String; Filter: Boolean)

Visibility:
public


10.5.4 : TMQTTTokenizer.Destroy
------------------------------------------------------------------------


Procedure:

Declaration:

destructor Destroy;  Override

Visibility:
public


10.5.5 : TMQTTTokenizer.AsString
------------------------------------------------------------------------


Procedure:

Declaration:

function AsString : string

Visibility:
public


10.5.6 : TMQTTTokenizer.Valid
------------------------------------------------------------------------



Property:

Declaration:

Property Valid : Boolean

Visibility:
public

Access:
Read


10.5.7 : TMQTTTokenizer.Count
------------------------------------------------------------------------



Property:

Declaration:

Property Count : Integer

Visibility:
public

Access:
Read


10.5.8 : TMQTTTokenizer.Items
------------------------------------------------------------------------



Property:

Declaration:

Property Items[Index: Integer]: TMQTTToken; default

Visibility:
public

Access:
Read

